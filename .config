# ================================================
# RK3128 索信 TP-9038 打印机服务器配置
# 修复：使用正确的RK3128目标架构
# ================================================

# 重要：使用正确的目标架构 - RK3128是32位ARMv7，不是ARMv8
CONFIG_TARGET_rockchip=y
CONFIG_TARGET_SUBTARGET="rk3128"
CONFIG_TARGET_rockchip_rk3128=y
CONFIG_TARGET_rockchip_rk3128_DEVICE_tlink-r1=y

# 镜像配置
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_ROOTFS_PARTSIZE=64
CONFIG_GRUB_IMAGES=n

# 内核配置 - RK3128是Cortex-A7 (32位ARMv7)
CONFIG_KERNEL_BUILD_USER="RK3128-Printer"
CONFIG_KERNEL_BUILD_DOMAIN="github.com"
CONFIG_KERNEL_CFLAGS="-O2 -pipe -mtune=cortex-a7"
CONFIG_KERNEL_DEBUG_INFO=n

# 架构配置 - 确保是32位ARM
CONFIG_ARM=y
CONFIG_ARCH_MULTI_V6_V7=y
CONFIG_CPU_V7=y
CONFIG_ARM_LPAE=n

# ================= 基础系统 =================
CONFIG_PACKAGE_block-mount=y
CONFIG_PACKAGE_fdisk=y
CONFIG_PACKAGE_lsblk=y
CONFIG_PACKAGE_usbutils=y

# ================= USB 支持 =================
CONFIG_PACKAGE_kmod-usb-core=y
CONFIG_PACKAGE_kmod-usb-ohci=y
CONFIG_PACKAGE_kmod-usb2=y
CONFIG_PACKAGE_kmod-usb-storage=y
CONFIG_PACKAGE_kmod-usb-printer=y

# ================= 网络驱动 =================
CONFIG_PACKAGE_kmod-r8169=y
CONFIG_PACKAGE_kmod-mii=y

# ================= 无线驱动 =================
CONFIG_PACKAGE_kmod-rtl8xxxu=y
CONFIG_PACKAGE_kmod-rtl8192cu=y
CONFIG_PACKAGE_kmod-rtlwifi=y
CONFIG_PACKAGE_kmod-rtlwifi-usb=y
CONFIG_PACKAGE_wpad-basic=y

# ================= 打印机服务 =================
CONFIG_PACKAGE_p910nd=y
CONFIG_PACKAGE_cups=y
CONFIG_PACKAGE_cups-filters=y
CONFIG_PACKAGE_cups-client=y

# CUPS 依赖
CONFIG_PACKAGE_ghostscript=y
CONFIG_PACKAGE_gsfonts=y
CONFIG_PACKAGE_foomatic-filters=y
CONFIG_PACKAGE_foomatic-db-engine=y

# ================= 库文件 =================
CONFIG_PACKAGE_libcups=y
CONFIG_PACKAGE_libcupsimage=y
CONFIG_PACKAGE_libpng=y
CONFIG_PACKAGE_libtiff=y
CONFIG_PACKAGE_libjpeg=y
CONFIG_PACKAGE_zlib=y

# ================= 管理界面 =================
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-base=y
CONFIG_PACKAGE_luci-compat=y
CONFIG_PACKAGE_luci-app-cups=y
CONFIG_PACKAGE_luci-app-p910nd=y
CONFIG_PACKAGE_luci-theme-bootstrap=y

# 中文支持
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y
CONFIG_PACKAGE_luci-i18n-cups-zh-cn=y
CONFIG_PACKAGE_luci-i18n-p910nd-zh-cn=y

# ================= 文件系统 =================
CONFIG_PACKAGE_kmod-fs-ext4=y
CONFIG_PACKAGE_kmod-fs-vfat=y

# ================= 工具 =================
CONFIG_PACKAGE_htop=y
CONFIG_PACKAGE_nano=y
CONFIG_PACKAGE_curl=y

# ================= SSH 服务 =================
CONFIG_PACKAGE_openssh-server=y
CONFIG_PACKAGE_dropbear=y

# ================= 网络配置 =================
CONFIG_PACKAGE_dnsmasq=y
CONFIG_PACKAGE_iptables=y

# ================= 时区 =================
CONFIG_PACKAGE_zoneinfo-asia=y

# ================= 优化 =================
CONFIG_CCACHE=y
CONFIG_BUILD_LOG=y

# ================= 明确禁用的包 =================
CONFIG_PACKAGE_dnsmasq-full=n
CONFIG_PACKAGE_firewall=n
CONFIG_PACKAGE_odhcpd=n
CONFIG_PACKAGE_ppp=n
CONFIG_PACKAGE_ppp-mod-pppoe=n
